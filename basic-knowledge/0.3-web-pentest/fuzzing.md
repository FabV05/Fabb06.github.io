# Fuzzing

## Web Fuzzing & Content Discovery

### Overview

**Web fuzzing** is the systematic testing of web applications by sending various inputs to discover hidden resources, parameters, and vulnerabilities. It's essential for comprehensive web application reconnaissance.

**Key Targets:**

* Directories and files
* File extensions
* Subdomains and virtual hosts
* Parameters (GET/POST)
* Authentication endpoints
* API endpoints

**Common Tools:**

* **ffuf** - Fast web fuzzer (recommended)
* **gobuster** - Directory/DNS brute-forcing
* **feroxbuster** - Recursive content discovery
* **wfuzz** - Web application fuzzer
* **dirsearch** - Directory scanner

***

### Exploitation Workflow Summary

```
1. Initial Discovery
   ├─ Identify web server/technology
   ├─ Basic directory enumeration
   ├─ Check for common files
   └─ Identify file extensions in use

2. Deep Enumeration
   ├─ Recursive directory fuzzing
   ├─ Extension-specific fuzzing
   ├─ Backup file discovery
   └─ Configuration file hunting

3. Subdomain/VHost Discovery
   ├─ Subdomain enumeration
   ├─ Virtual host fuzzing
   ├─ DNS brute-forcing
   └─ Certificate transparency logs

4. Parameter Discovery
   ├─ GET parameter fuzzing
   ├─ POST parameter fuzzing
   ├─ Hidden parameter identification
   └─ API endpoint discovery

5. Exploitation
   ├─ Test discovered endpoints
   ├─ Analyze exposed data
   ├─ Test for vulnerabilities
   └─ Chain findings for impact
```

***

### Directory & File Fuzzing

#### Basic Directory Enumeration

**ffuf (recommended):**

```bash
ffuf -w /usr/share/wordlists/dirb/common.txt -u http://target.com/FUZZ
```

**gobuster:**

```bash
gobuster dir -w /usr/share/wordlists/dirb/common.txt -u http://target.com
```

**feroxbuster:**

```bash
feroxbuster -u http://target.com -w /usr/share/wordlists/dirb/common.txt
```

#### Extension-Specific Fuzzing

**Understanding the need:** Different applications use different file extensions. Knowing the technology stack helps target the right extensions efficiently.

**Common extensions by technology:**

```
PHP:      .php, .php3, .php4, .php5, .phtml
ASP.NET:  .asp, .aspx, .asmx, .ashx
JSP:      .jsp, .jsf, .jspx
Python:   .py
Ruby:     .rb
Perl:     .pl, .cgi
```

**ffuf with specific extension (PHP example):**

```bash
ffuf -w /usr/share/seclists/Discovery/Web-Content/directory-list-2.3-small.txt:FUZZ \
  -u http://target.com/blog/FUZZ.php
```

**gobuster with multiple extensions:**

```bash
gobuster dir -w /usr/share/seclists/Discovery/Web-Content/big.txt \
  -u http://target.com/dev/ \
  -x php \
  -k  # Skip SSL certificate verification
```

**Multiple extensions at once:**

```bash
# Test multiple extensions
gobuster dir -u http://target.com \
  -w /usr/share/wordlists/dirb/common.txt \
  -x php,html,txt,bak,old

# With ffuf
ffuf -w /usr/share/wordlists/dirb/common.txt -u http://target.com/FUZZ \
  -e .php,.html,.txt,.bak
```

#### Recursive Fuzzing

**What is recursive fuzzing?** After finding a directory, automatically fuzz inside it to discover nested resources.

**ffuf recursive:**

```bash
ffuf -w /usr/share/wordlists/seclists/Discovery/Web-Content/directory-list-2.3-small.txt:FUZZ \
  -u http://target.com/FUZZ \
  -recursion \
  -recursion-depth 1 \
  -e .php \
  -v  # Verbose output
```

**Parameters explained:**

* `-recursion` - Enable recursive fuzzing
* `-recursion-depth 1` - How many levels deep to go
* `-e .php` - Extensions to append
* `-v` - Show full URL in output

**Example workflow:**

```bash
# Level 1: Find /admin/
# Level 2: Automatically fuzz /admin/FUZZ
# Result: Discover /admin/login.php, /admin/config.php
```

**feroxbuster (built-in recursion):**

```bash
feroxbuster -u http://target.com \
  -w /usr/share/wordlists/dirb/common.txt \
  -x php,html \
  --depth 3
```

***

### Git Repository Discovery

#### The .git/ Directory Problem

**Common scenario:**

```bash
# Direct access blocked
curl http://target.com/.git/
# Returns: 403 Forbidden

# But individual files accessible!
curl http://target.com/.git/config
# Returns: 200 OK (with content!)
```

**Why this happens:**

* Web servers block directory listing (403)
* But forget to block individual files (200)
* Allows reconstruction of entire repository

#### Exploiting Exposed .git

**Manual file enumeration:**

```bash
# Try common .git files
curl http://target.com/.git/config
curl http://target.com/.git/HEAD
curl http://target.com/.git/index
curl http://target.com/.git/logs/HEAD
```

**Automated tools:**

**git-dumper:**

```bash
# Clone exposed .git directory
git-dumper http://target.com/.git/ output_directory/
```

**GitTools:**

```bash
# Dump repository
./gitdumper.sh http://target.com/.git/ output_directory/

# Extract commits
./extractor.sh output_directory/ extracted/
```

**What to look for in extracted repo:**

```bash
# Search for credentials
grep -r "password" .
grep -r "api_key" .
grep -r "secret" .

# Check commit history
git log --all --full-history

# View deleted files
git log --diff-filter=D --summary
```

***

### Subdomain Enumeration

#### DNS-Based Subdomain Discovery

**ffuf subdomain fuzzing:**

```bash
ffuf -w /usr/share/wordlists/seclists/Discovery/DNS/subdomains-top1million-5000.txt:FUZZ \
  -u http://FUZZ.academy.htb/
```

**Why it works:**

* Tests `FUZZ.academy.htb` with each wordlist entry
* Example: `admin.academy.htb`, `dev.academy.htb`, `api.academy.htb`

**gobuster DNS mode:**

```bash
gobuster dns -d academy.htb \
  -w /usr/share/wordlists/seclists/Discovery/DNS/subdomains-top1million-5000.txt
```

**Filter by response characteristics:**

```bash
# Filter out default responses by size
ffuf -w /usr/share/wordlists/seclists/Discovery/DNS/subdomains-top1million-5000.txt:FUZZ \
  -u http://FUZZ.academy.htb/ \
  -fs 1234  # Filter responses of size 1234 bytes
```

***

### Virtual Host (VHost) Fuzzing

#### Understanding Virtual Hosts

**What are VHosts?** Multiple websites hosted on the same IP address, distinguished by the `Host` header.

**VHost vs Subdomain:**

* **Subdomain**: DNS-resolvable (dev.example.com)
* **VHost**: Not in DNS, only responds to specific Host header

**Example scenario:**

```
IP: 10.10.10.10
VHosts:
  - Host: admin.internal.local
  - Host: staging.internal.local
  - Host: backup.internal.local
```

#### VHost Fuzzing with ffuf

**Basic VHost enumeration:**

```bash
ffuf -w /usr/share/wordlists/seclists/Discovery/DNS/subdomains-top1million-5000.txt:FUZZ \
  -u http://academy.htb:PORT/ \
  -H 'Host: FUZZ.academy.htb'
```

**How it works:**

```http
GET / HTTP/1.1
Host: admin.academy.htb    # Tests this host
```

#### Filtering False Positives

**Problem:** Many VHost scans return identical responses for non-existent hosts.

**Solution: Filter by response size**

```bash
# First, find default response size
curl -H "Host: nonexistent.academy.htb" http://academy.htb:PORT/
# Note the Content-Length: 900

# Filter it out
ffuf -w /usr/share/wordlists/seclists/Discovery/DNS/subdomains-top1million-5000.txt:FUZZ \
  -u http://academy.htb:PORT/ \
  -H 'Host: FUZZ.academy.htb' \
  -fs 900  # Filter size 900
```

**Multiple filters:**

```bash
# Filter by size and status code
ffuf -w wordlist.txt:FUZZ \
  -u http://target.com/ \
  -H 'Host: FUZZ.target.com' \
  -fs 1234 \
  -fc 404,403
```

**Available filters:**

```
-fs SIZE    Filter HTTP response size
-fc CODE    Filter HTTP status codes
-fw WORDS   Filter by word count
-fl LINES   Filter by line count
-fr REGEX   Filter by regex pattern
-ft TIME    Filter by response time
```

***

### Parameter Fuzzing

#### GET Parameter Discovery

**What are GET parameters?** Values passed in the URL query string:

```
http://target.com/page.php?id=1&action=view
                           ↑              ↑
                       Parameter 1    Parameter 2
```

**Why fuzz for parameters?**

* Developers often create hidden/undocumented parameters
* May expose debugging functions
* Can reveal additional functionality

**ffuf GET parameter fuzzing:**

```bash
ffuf -w /usr/share/wordlists/seclists/Discovery/Web-Content/burp-parameter-names.txt:FUZZ \
  -u 'http://admin.academy.htb:50855/admin/admin.php?FUZZ=key' \
  -fs xxx  # Filter default response size
```

**Example discovery:**

```bash
# Testing http://target.com/admin.php?FUZZ=test
# Discovers: ?debug=test (200 OK, different size)
# Discovers: ?mode=test (200 OK, different size)
# Discovers: ?action=test (200 OK, different size)
```

**Testing discovered parameters:**

```bash
# Test with various values
curl 'http://target.com/admin.php?debug=1'
curl 'http://target.com/admin.php?debug=true'
curl 'http://target.com/admin.php?action=list'
```

#### POST Parameter Discovery

**What are POST parameters?** Data sent in the request body (not visible in URL):

```http
POST /login.php HTTP/1.1
Content-Type: application/x-www-form-urlencoded

username=admin&password=secret
```

**ffuf POST parameter fuzzing:**

```bash
ffuf -w /usr/share/wordlists/seclists/Discovery/Web-Content/burp-parameter-names.txt:FUZZ \
  -u http://admin.academy.htb:PORT/admin/admin.php \
  -X POST \
  -d 'FUZZ=key' \
  -H 'Content-Type: application/x-www-form-urlencoded' \
  -fs xxx  # Filter default response size
```

**Parameters explained:**

* `-X POST` - Use POST method
* `-d 'FUZZ=key'` - POST data with parameter to fuzz
* `-H 'Content-Type: ...'` - Set proper content type
* `-fs xxx` - Filter default response size

#### Testing Discovered Parameters

**Manual validation with curl:**

```bash
curl http://admin.academy.htb:PORT/admin/admin.php \
  -X POST \
  -d 'id=key' \
  -H 'Content-Type: application/x-www-form-urlencoded'
```

**Example response:**

```html
<div class='center'><p>Invalid id!</p></div>
```

**This tells us:**

* Parameter `id` exists
* It expects a specific value (not "key")
* Need to fuzz the parameter value next

**Value fuzzing:**

```bash
# Fuzz the parameter value
ffuf -w /usr/share/wordlists/seclists/Fuzzing/special-chars.txt:FUZZ \
  -u http://admin.academy.htb:PORT/admin/admin.php \
  -X POST \
  -d 'id=FUZZ' \
  -H 'Content-Type: application/x-www-form-urlencoded'
```

***

### Advanced Fuzzing Techniques

#### Combining Multiple Fuzz Points

**URL and parameter fuzzing:**

```bash
# Fuzz both directory and parameter
ffuf -w directories.txt:DIR -w parameters.txt:PARAM \
  -u http://target.com/DIR/page.php?PARAM=test
```

**Multiple parameters:**

```bash
# Fuzz two parameters
ffuf -w params1.txt:P1 -w params2.txt:P2 \
  -u http://target.com/page.php?P1=value1&P2=value2
```

#### Content-Type Fuzzing

**JSON endpoints:**

```bash
ffuf -w parameter-names.txt:FUZZ \
  -u http://api.target.com/endpoint \
  -X POST \
  -d '{"FUZZ":"test"}' \
  -H 'Content-Type: application/json'
```

**XML endpoints:**

```bash
ffuf -w parameter-names.txt:FUZZ \
  -u http://api.target.com/endpoint \
  -X POST \
  -d '<root><FUZZ>test</FUZZ></root>' \
  -H 'Content-Type: application/xml'
```

#### Response Analysis

**Match specific strings:**

```bash
# Only show responses containing "admin"
ffuf -w wordlist.txt \
  -u http://target.com/FUZZ \
  -mr "admin"
```

**Filter by regex:**

```bash
# Filter out error messages
ffuf -w wordlist.txt \
  -u http://target.com/FUZZ \
  -fr "error|not found|404"
```

***

### Wordlist Selection

#### Recommended Wordlists (SecLists)

**General directories:**

```bash
# Small (fast)
/usr/share/seclists/Discovery/Web-Content/directory-list-2.3-small.txt

# Medium (balanced)
/usr/share/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt

# Big (comprehensive)
/usr/share/seclists/Discovery/Web-Content/big.txt
```

**Subdomains:**

```bash
/usr/share/seclists/Discovery/DNS/subdomains-top1million-5000.txt
/usr/share/seclists/Discovery/DNS/subdomains-top1million-20000.txt
```

**Parameters:**

```bash
/usr/share/seclists/Discovery/Web-Content/burp-parameter-names.txt
/usr/share/seclists/Discovery/Web-Content/api/api-endpoints.txt
```

**Backup files:**

```bash
/usr/share/seclists/Discovery/Web-Content/web-all-content-types.txt
```

#### Technology-Specific Wordlists

**PHP:**

```bash
/usr/share/seclists/Discovery/Web-Content/CommonBackdoors-PHP.fuzz.txt
```

**API endpoints:**

```bash
/usr/share/seclists/Discovery/Web-Content/api/api-endpoints.txt
```

***

### Practical Examples

#### Complete Enumeration Workflow

**Step 1: Initial directory scan**

```bash
ffuf -w /usr/share/seclists/Discovery/Web-Content/directory-list-2.3-small.txt \
  -u http://target.com/FUZZ
```

**Step 2: Add extensions based on technology**

```bash
# Found: /admin/ directory
# Technology: PHP
ffuf -w /usr/share/wordlists/dirb/common.txt \
  -u http://target.com/admin/FUZZ \
  -e .php,.inc,.bak
```

**Step 3: Recursive fuzzing**

```bash
ffuf -w /usr/share/wordlists/dirb/common.txt \
  -u http://target.com/FUZZ \
  -recursion \
  -recursion-depth 2 \
  -e .php
```

**Step 4: Parameter fuzzing**

```bash
# Found: /admin/panel.php
ffuf -w /usr/share/seclists/Discovery/Web-Content/burp-parameter-names.txt:FUZZ \
  -u 'http://target.com/admin/panel.php?FUZZ=test'
```

#### Real-World Scenario

```bash
# 1. Subdomain discovery
ffuf -w /usr/share/seclists/Discovery/DNS/subdomains-top1million-5000.txt:FUZZ \
  -u http://FUZZ.target.com/ \
  -fs 1234

# Found: dev.target.com

# 2. Directory enumeration on subdomain
ffuf -w /usr/share/wordlists/dirb/common.txt \
  -u http://dev.target.com/FUZZ \
  -e .php,.bak

# Found: /backup/, /config.php.bak

# 3. Download exposed backup
curl http://dev.target.com/config.php.bak -o config.php.bak

# 4. Analyze for credentials
cat config.php.bak | grep -i "password\|user\|key"
```

***

### Quick Reference

#### ffuf Commands

```bash
# Basic fuzzing
ffuf -w wordlist.txt -u http://target.com/FUZZ

# With extensions
ffuf -w wordlist.txt -u http://target.com/FUZZ -e .php,.html

# Recursive
ffuf -w wordlist.txt -u http://target.com/FUZZ -recursion -recursion-depth 2

# Subdomain
ffuf -w wordlist.txt -u http://FUZZ.target.com/

# VHost
ffuf -w wordlist.txt -u http://target.com/ -H 'Host: FUZZ.target.com' -fs 1234

# GET parameter
ffuf -w wordlist.txt -u 'http://target.com/page.php?FUZZ=test'

# POST parameter
ffuf -w wordlist.txt -u http://target.com/page.php -X POST -d 'FUZZ=test'
```

#### gobuster Commands

```bash
# Directory
gobuster dir -u http://target.com -w wordlist.txt -x php,html

# DNS
gobuster dns -d target.com -w wordlist.txt

# VHost
gobuster vhost -u http://target.com -w wordlist.txt
```



